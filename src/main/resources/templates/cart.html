<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head('Checkout')"></head>
<body>
<header th:replace="fragments/header :: header"></header>
  <div class="container mt-5">
    <h2 class="mb-4">Tu Carrito de Compras</h2>

    <div id="empty-cart-message" th:if="${cart.items.isEmpty()}">
      <div class="alert alert-info">
        Tu carrito está vacío. <a th:href="@{/products}">Continúa comprando</a>.
      </div>
    </div>

    <div id="cart-content" th:if="${!cart.items.isEmpty()}">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
          <tr>
            <th>Producto</th>
            <th>Precio</th>
            <th>Cantidad</th>
            <th>Subtotal</th>
            <th>Acciones</th>
          </tr>
          </thead>
          <tbody id="cart-items">
          <tr th:each="item : ${cart.items}">
            <td th:text="${item.product.name}">Producto</td>
            <td th:text="${'$' + #numbers.formatDecimal(item.product.price, 1, 2)}">$0.00</td>
            <td>
              <div class="input-group input-group-sm" style="width: 120px;">
                <button class="btn btn-outline-secondary decrease-quantity" th:data-id="${item.product.id}">-</button>
                <input type="text" class="form-control text-center" th:value="${item.quantity}" readonly>
                <button class="btn btn-outline-secondary increase-quantity" th:data-id="${item.product.id}">+</button>
              </div>
            </td>
            <td th:text="${'$' + #numbers.formatDecimal(item.product.price * item.quantity, 1, 2)}">$0.00</td>
            <td>
              <button class="btn btn-sm btn-danger remove-item" th:data-id="${item.product.id}">Eliminar</button>
            </td>
          </tr>
          </tbody>
          <tfoot>
          <tr>
            <td colspan="3" class="text-end"><strong>Total:</strong></td>
            <td><strong th:text="${'$' + #numbers.formatDecimal(cart.totalAmount, 1, 2)}" id="cart-total">$0.00</strong></td>
            <td></td>
          </tr>
          </tfoot>
        </table>
      </div>

      <div class="d-flex justify-content-between mt-4">
        <a th:href="@{/products}" class="btn btn-secondary">Continuar Comprando</a>
        <a th:href="@{/checkout}" class="btn btn-primary" id="checkout-button" th:disabled="${cart.totalItems > 10}">Proceder al Pago</a>
      </div>

      <div class="text-danger mt-2" th:if="${cart.totalItems > 10}">
        Un pedido no puede tener más de 10 productos
      </div>
    </div>
  </div>
<footer th:replace="fragments/footer :: footer"></footer>
<script th:src="@{/js/cart.js}"></script>
</body>
</html>

